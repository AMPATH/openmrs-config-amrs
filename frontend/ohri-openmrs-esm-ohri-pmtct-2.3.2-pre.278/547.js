"use strict";(globalThis.webpackChunk_ohri_openmrs_esm_ohri_pmtct=globalThis.webpackChunk_ohri_openmrs_esm_ohri_pmtct||[]).push([[547],{7408:(t,e,n)=>{n.a(t,(async(t,r)=>{try{n.d(e,{bL:()=>l,bo:()=>c,bq:()=>f,fX:()=>o,g3:()=>d,g9:()=>p,lP:()=>s});var a=n(2870);n(2268);var i="/ws/rest/v1/";function o(t){return(0,a.openmrsFetch)("/ws/rest/v1/idgen/identifiersource/".concat(t,"/identifier"),{headers:{"Content-Type":"application/json"},method:"POST",body:{}})}function u(t){return(0,a.openmrsFetch)("/ws/rest/v1/patient",{headers:{"Content-Type":"application/json"},method:"POST",body:t})}function c(t){return Promise.all(t.map((function(t){return u(t)})))}function l(t){return(0,a.openmrsFetch)("/ws/rest/v1/relationship",{headers:{"Content-Type":"application/json"},method:"POST",body:t})}function s(t){return(0,a.openmrsFetch)("".concat(i,"/patient/").concat(t,"/identifier")).then((function(t){var e=t.data;return e.results.length?e.results:null}))}function d(t,e){return(0,a.openmrsFetch)("".concat(i,"patient/").concat(e,"/identifier"),{headers:{"Content-Type":"application/json"},method:"POST",body:t})}function p(t){return(0,a.openmrsFetch)("".concat(i,"patient?identifier=").concat(t,"&v=custom:(identifiers:(identifier,identifierType:(uuid,display)),person:(uuid,display))")).then((function(t){return t.data||null}))}function f(t,e,n){var r="patient=".concat(t,"&code=").concat(e).concat(n?"&encounter.type=".concat(n):"");return r+="&_sort=-_lastUpdated&_count=1",(0,a.openmrsFetch)("/ws/fhir2/R4/Observation?".concat(r)).then((function(t){var e,n,r=t.data;return(null===(e=r.entry)||void 0===e?void 0:e.length)?null===(n=r.entry[0].resource.valueCodeableConcept.coding[0])||void 0===n?void 0:n.display:null}))}await(0,a.getConfig)("@ohri/openmrs-esm-ohri-pmtct"),r()}catch(h){r(h)}}),1)},9547:(t,e,n)=>{n.a(t,(async(t,r)=>{try{n.r(e),n.d(e,{default:()=>m});var a=n(268),i=n.n(a),o=n(4924),u=n(6254),c=n(8559),l=n(49),s=n(7816),d=n(2870),p=n(3565),f=n.n(p),h=t([l,s]);[l,s]=h.then?(await h)():h;const m=function(t){var e=t.patientUuid,n=(0,o.useTranslation)().t,r=(0,d.usePatient)(e),p=r.patient,h=r.isLoading,m=null==p?void 0:p.birthDate,y=(0,a.useMemo)((function(){return f()().diff(f()(null==p?void 0:p.birthDate),"year")}),[null==p?void 0:p.birthDate]);return i().createElement(i().Fragment,null,h?i().createElement(u.gqd,{rowCount:5}):i().createElement("div",{className:c.Z.tabContainer},y>10?i().createElement(u.mQc,null,i().createElement(u.tdY,{contained:!0},i().createElement(u.OK9,null,n("recentPregnancy","Recent Pregnancy"))),i().createElement(u.nPR,null,i().createElement(u.x45,null,i().createElement(l.Z,{patientUuid:e})))):i().createElement(u.mQc,null,i().createElement(u.tdY,{contained:!0},i().createElement(u.OK9,null,n("hivExposedInfant","HIV Exposed Infant"))),i().createElement(u.nPR,null,i().createElement(u.x45,null,i().createElement(s.Z,{patientUuid:e,dateOfBirth:m}))))))};r()}catch(t){r(t)}}))},49:(t,e,n)=>{n.a(t,(async(t,r)=>{try{n.d(e,{Z:()=>x});var a=n(268),i=n.n(a),o=n(4924),u=n(2268),c=n(3565),l=n.n(c),s=n(926),d=n(6254),p=n(2870),f=n(7408),h=t([f]);function m(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function y(t){if(Array.isArray(t))return t}function v(t,e,n,r,a,i,o){try{var u=t[i](o),c=u.value}catch(t){return void n(t)}u.done?e(c):Promise.resolve(c).then(r,a)}function T(t){return function(){var e=this,n=arguments;return new Promise((function(r,a){var i=t.apply(e,n);function o(t){v(i,r,a,o,u,"next",t)}function u(t){v(i,r,a,o,u,"throw",t)}o(void 0)}))}}function b(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,a,i=[],o=!0,u=!1;try{for(n=n.call(t);!(o=(r=n.next()).done)&&(i.push(r.value),!e||i.length!==e);o=!0);}catch(t){u=!0,a=t}finally{try{o||null==n.return||n.return()}finally{if(u)throw a}}return i}}function I(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function g(t,e){return y(t)||b(t,e)||k(t,e)||I()}function k(t,e){if(t){if("string"==typeof t)return m(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?m(t,e):void 0}}function S(t,e){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!((a=(a=o.trys).length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=e.call(t,o)}catch(t){i=[6,t],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}}f=(h.then?(await h)():h)[0];const x=function(t){var e=t.patientUuid,n=(0,o.useTranslation)().t,r=n("recentPregnancy","Recent Pregnancy"),c=n("art","ART"),h=n("appointments","Appointments"),m=n("family","Family"),y=n("infantStatusAtBirth","Infant Status At Birth"),v=n("previousVisitsSummary","Previous Visits"),b=g((0,a.useState)([]),2),I=b[0],k=b[1],x=g((0,a.useState)([]),2),D=x[0],F=x[1],w=g((0,a.useState)([]),2),O=w[0],V=w[1],P=g((0,a.useState)([]),2),C=P[0],E=P[1],A=(0,p.useConfig)(),B=A.formNames,U=A.encounterTypes,M=A.obsConcepts,R=A.formUuids,N=g((0,a.useState)(null),2),_=N[0],H=N[1];(0,a.useEffect)((function(){var t,e=(t=T((function(){var t,e,n;return S(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,Promise.all([(0,u._z5)("no_of_anc_visits")])];case 1:return t=g.apply(void 0,[r.sent(),1]),e=t[0],H(e),[3,3];case 2:throw n=r.sent(),console.error("Error fetching data:",n),new Error("Error fetching data. Please try again.");case 3:return[2]}}))})),function(){return t.apply(this,arguments)});e()}),[]);var Y=[{header:n("pTrackerId","PTracker ID"),key:"pTrackerId"},{header:n("name","Name"),key:"name"},{header:n("relationship","Relationship"),key:"relationship"},{header:n("dateOfBirth","Date of birth"),key:"dateOfBirth"},{header:n("hivStatus","HIV Status"),key:"hivStatus"},{header:n("finalOutcome","Final Outcome"),key:"finalOutcome"}],j=[{header:n("pTrackerId","PTracker ID"),key:"pTrackerId"},{header:n("dateOfBirth","Date of Birth"),key:"dateOfBirth"},{header:n("infantStatus","Infant Status at Birth"),key:"infantStatus"},{header:n("breastfeeding","Breast Feeding"),key:"breastfeeding"}];function L(){return(L=T((function(){var t,n;return S(this,(function(r){switch(r.label){case 0:return t=[],[4,(0,u.IXl)(e)];case 1:return(null==(n=r.sent())?void 0:n.length)&&n.forEach((function(e){t.push(e)})),k(t),[2]}}))}))).apply(this,arguments)}function Z(){return(Z=T((function(){var t,n,r;return S(this,(function(a){switch(a.label){case 0:return[4,(0,u.syo)(e,U.antenatal)];case 1:return t=a.sent(),[4,(0,u.syo)(e,U.labourAndDelivery)];case 2:return((null==(n=a.sent())?void 0:n.encounterDatetime)>(null==t?void 0:t.encounterDatetime)||null==(null==t?void 0:t.encounterDatetime))&&null!==n&&V(null===(r=n.obs)||void 0===r?void 0:r.filter((function(t){return t.concept.uuid===M.infantDeliveryGroupingConcept}))),[2]}}))}))).apply(this,arguments)}(0,a.useEffect)((function(){!function(){Z.apply(this,arguments)}(),function(){L.apply(this,arguments)}()}),[]),(0,a.useEffect)((function(){var t=I.map((function(t){return function(t){return G.apply(this,arguments)}(t.personB.uuid)}));Promise.all(t).then((function(t){F(t.map((function(t){return{patientId:t.patientId,pTrackerId:t.pTrackerId}})))})),q()}),[I]);var q=function(){var t,e=I.map((t=T((function(t){return S(this,(function(e){switch(e.label){case 0:return[4,(0,f.bq)(t.personB.uuid,M.outcomeStatus,U.infantPostnatal)];case 1:return[2,{finalOutcome:e.sent(),childUuid:t.personB.uuid}]}}))})),function(e){return t.apply(this,arguments)}));Promise.all(e).then((function(t){E(t.map((function(t){return{finalOutcome:t.finalOutcome,childUuid:t.childUuid}})))}))};function G(){return G=T((function(t){var e,n,r,a;return S(this,(function(i){switch(i.label){case 0:return e={patientId:t,pTrackerId:"--"},[4,(0,f.lP)(t)];case 1:return(null==(n=i.sent())?void 0:n.length)&&(e.pTrackerId=null!==(a=null===(r=n.find((function(t){return t.identifierType.uuid===U.PTrackerIdentifierType})))||void 0===r?void 0:r.identifier)&&void 0!==a?a:"--"),[2,e]}}))})),G.apply(this,arguments)}var X=(0,a.useMemo)((function(){var t=[];return I.forEach((function(n){if(n.personB.uuid!==e){var r,a,o,c=i().createElement(d.rUS,{onClick:function(t){t.preventDefault(),(0,p.navigate)({to:"".concat(u.sb4).concat(n.personB.uuid,"/chart")})}},n.personB.display),s={id:n.uuid,pTrackerId:null===(r=D.find((function(t){return t.patientId===n.personB.uuid})))||void 0===r?void 0:r.pTrackerId,name:c,relationship:n.relationshipType.displayBIsToA,dateOfBirth:l()(n.personB.birthdate).format("DD-MMM-YYYY"),hivStatus:"",finalOutcome:null!==(o=null===(a=C.find((function(t){return t.childUuid===n.personB.uuid})))||void 0===a?void 0:a.finalOutcome)&&void 0!==o?o:"--"};t.push(s)}})),t}),[I,e,D,C]),K=(0,a.useMemo)((function(){var t=[];return O.forEach((function(e){var n,r,a,i,o,u,c,s=e.groupMembers.find((function(t){return t.concept.uuid===M.infantStatusAtBirthConcept})),d={id:e.uuid,pTrackerId:null===(n=e.groupMembers.find((function(t){return t.concept.uuid===M.infantPTrackerIdConcept})))||void 0===n?void 0:n.value,dateOfBirth:l()(null===(r=e.groupMembers.find((function(t){return t.concept.uuid===M.infantDateOfBirth})))||void 0===r?void 0:r.value).format("DD-MMM-YYYY"),infantStatus:(null===(o=s.value)||void 0===o||null===(i=o.names)||void 0===i||null===(a=i.find((function(t){return"SHORT"===t.conceptNameType})))||void 0===a?void 0:a.name)||s.value.name.name,breastfeeding:null===(c=e.groupMembers.find((function(t){return t.concept.uuid===M.breastfeedingStatus})))||void 0===c||null===(u=c.value)||void 0===u?void 0:u.display};t.push(d)})),t}),[O,C]),Q=(0,a.useMemo)((function(){return[{key:"motherHIVStatus",header:n("motherHIVStatus","Mother HIV Status"),encounterTypes:[U.motherPostnatal,U.labourAndDelivery,U.antenatal],getObsValue:function(t){var e={artInitiation:(0,u.hFx)(t[0],M.artInitiationConcept),motherHIVStatus:(0,u.hFx)(t[0],M.hivTestResultConcept),pTrackerId:(0,u.hFx)(t[0],M.pTrackerIdConcept)},n={artInitiation:(0,u.hFx)(t[1],M.artInitiationConcept),motherHIVStatus:(0,u.hFx)(t[1],M.hivTestResultConcept),pTrackerId:(0,u.hFx)(t[1],M.pTrackerIdConcept)},r={artInitiation:(0,u.hFx)(t[2],M.artInitiationConcept),motherHIVStatus:(0,u.hFx)(t[2],M.hivTestResultConcept),pTrackerId:(0,u.hFx)(t[2],M.pTrackerIdConcept)},a=W(e,n,r);return a.motherHIVStatus?a.motherHIVStatus:"--"}},{key:"expectedDeliveryDate",header:n("expectedDeliveryDate","Expected Delivery Date"),encounterTypes:[U.antenatal],getObsValue:(t=T((function(t){var e,n;return S(this,(function(r){return e=g(t,1),n=e[0],[2,(0,u.hFx)(n,M.eDDConcept,!0)]}))})),function(e){return t.apply(this,arguments)}),getObsSummary:function(t){var e=g(t,1)[0],n=(0,u.hFx)(e,M.eDDConcept,!0);if("--"!==n){var r=tt(n);n=n>0?"In ".concat(r):""}return n}},{key:"motherStatus",header:n("motherStatus","Mother Status"),encounterTypes:[U.labourAndDelivery],getObsValue:function(){var t=T((function(t){var e,n;return S(this,(function(r){return e=g(t,1),n=e[0],[2,(0,u.hFx)(n,M.motherStatusConcept)]}))}));return function(e){return t.apply(this,arguments)}}()}];var t}),[]),$=(0,a.useMemo)((function(){return[{key:"artInitiation",header:n("artInitiation","ART Initiation"),encounterTypes:[U.motherPostnatal,U.labourAndDelivery,U.antenatal],getObsValue:function(t){var e={artInitiation:(0,u.hFx)(t[0],M.artInitiationConcept),artStartDate:(0,u.hFx)(t[0],M.artStartDate,!0),pTrackerId:(0,u.hFx)(t[0],M.pTrackerIdConcept)},n={artInitiation:(0,u.hFx)(t[1],M.artInitiationConcept),artStartDate:(0,u.hFx)(t[1],M.artStartDate,!0),pTrackerId:(0,u.hFx)(t[1],M.pTrackerIdConcept)},r={artInitiation:(0,u.hFx)(t[2],M.artInitiationConcept),artStartDate:(0,u.hFx)(t[2],M.artStartDate,!0),pTrackerId:(0,u.hFx)(t[2],M.pTrackerIdConcept)};return W(e,n,r).artInitiation}},{key:"artStartDate",header:n("artStartDate","ART Start Date"),encounterTypes:[U.motherPostnatal,U.labourAndDelivery,U.antenatal],getObsValue:function(t){var e={artInitiation:(0,u.hFx)(t[0],M.artInitiationConcept),artStartDate:(0,u.hFx)(t[0],M.artStartDate,!0),pTrackerId:(0,u.hFx)(t[0],M.pTrackerIdConcept)},n={artInitiation:(0,u.hFx)(t[1],M.artInitiationConcept),artStartDate:(0,u.hFx)(t[1],M.artStartDate,!0),pTrackerId:(0,u.hFx)(t[1],M.pTrackerIdConcept)},r={artInitiation:(0,u.hFx)(t[2],M.artInitiationConcept),artStartDate:(0,u.hFx)(t[2],M.artStartDate,!0),pTrackerId:(0,u.hFx)(t[2],M.pTrackerIdConcept)};return W(e,n,r).artStartDate}}]}),[]),z=(0,a.useMemo)((function(){return[{key:"nextAppointmentDate",header:n("nextAppointmentDate","Next Appointment Date"),encounterTypes:[U.antenatal],getObsValue:function(t){var e=g(t,1)[0];return(0,u.hFx)(e,M.nextVisitDateConcept,!0)},getObsSummary:function(t){var e=g(t,1)[0],n=(0,u.hFx)(e,M.nextVisitDateConcept,!0);if("--"!==n){var r=tt(n);n=n>0?"In ".concat(r):""}return n}},{key:"ancVisitsAttended",header:n("ancVisitsAttended","ANC visits attended"),encounterTypes:[U.antenatal],getObsValue:(t=T((function(t){return S(this,(function(e){return g(t,1)[0],[2,_]}))})),function(e){return t.apply(this,arguments)})}];var t}),[_]),J=(0,a.useMemo)((function(){return[{key:"visitType",header:n("visitType","Visit Type"),getValue:function(t){return t.encounterType.name}},{key:"visitDate",header:n("visitDate","Visit date"),getValue:function(t){return(0,u.hFx)(t,M.visitDate,!0)}},{key:"facility",header:n("facility","Facility"),getValue:function(t){return t.location.name}},{key:"nextFollowUpDate",header:n("nextFollowUpDate","Next Follow-up date"),getValue:function(t){return(0,u.hFx)(t,M.followUpDateConcept,!0)}},{key:"actions",header:n("actions","Actions"),getValue:function(t){return[{form:et(t),encounterUuid:t.uuid,intent:"*",label:n("viewDetails","View details"),mode:"view"}]}}]}),[]),W=function(t,e,n){var r=[t,e,n].filter((function(t){return"--"!==t.artInitiation}));return 0==r.length?{artInitiation:"--",artStartDate:"--"}:(1==r.length||r.sort((function(t,e){return e.pTrackerId.localeCompare(t.pTrackerId)})),r[0])},tt=function(t){var e=new Date(t).getTime()-(new Date).getTime(),n=Math.floor(e/864e5);return"".concat(n," day(s)")},et=function(t){var e=t.encounterType.name;return"Antenatal"===e?{name:B.antenatal}:"Labor and Delivery"===e?{name:B.labourAndDelivery}:{name:B.motherPostnatal}};return i().createElement("div",null,i().createElement(u.eBf,{patientUuid:e,headerTitle:r,columns:Q}),i().createElement("div",{style:{display:"flex",flexDirection:"row",gap:"1rem",height:"15rem"}},i().createElement(u.eBf,{patientUuid:e,headerTitle:c,columns:$}),i().createElement(u.eBf,{patientUuid:e,headerTitle:h,columns:z})),i().createElement("div",{style:{marginTop:"1rem",marginBottom:"1rem"}},i().createElement(u.BRj,{patientUuid:e,headerTitle:y,headers:j,items:K,isActionable:!0,isStriped:!0,launchOptions:{hideFormLauncher:!0,moduleName:"",displayText:""}}),i().createElement(u.BRj,{patientUuid:e,headerTitle:m,headers:Y,items:X,isActionable:!0,isStriped:!0,launchOptions:{hideFormLauncher:!0,moduleName:"",displayText:""}})),i().createElement(u.IOg,{patientUuid:e,encounterType:U.mchEncounterType,columns:J,description:v,headerTitle:v,formList:[{name:B.antenatal,uuid:""},{name:B.labourAndDelivery,uuid:R.labourAndDelivery},{name:B.motherPostnatal,uuid:R.motherPostnatal}],launchOptions:{hideFormLauncher:!0,moduleName:s.moduleName,displayText:""}}))};r()}catch(D){r(D)}}))},7816:(t,e,n)=>{n.a(t,(async(t,r)=>{try{n.d(e,{Z:()=>x});var a=n(268),i=n.n(a),o=n(4924),u=n(2268),c=n(2870),l=n(3565),s=n.n(l),d=n(6254),p=n(926),f=n(7408),h=t([f]);function m(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function y(t){if(Array.isArray(t))return t}function v(t,e,n,r,a,i,o){try{var u=t[i](o),c=u.value}catch(t){return void n(t)}u.done?e(c):Promise.resolve(c).then(r,a)}function T(t){return function(){var e=this,n=arguments;return new Promise((function(r,a){var i=t.apply(e,n);function o(t){v(i,r,a,o,u,"next",t)}function u(t){v(i,r,a,o,u,"throw",t)}o(void 0)}))}}function b(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,a,i=[],o=!0,u=!1;try{for(n=n.call(t);!(o=(r=n.next()).done)&&(i.push(r.value),!e||i.length!==e);o=!0);}catch(t){u=!0,a=t}finally{try{o||null==n.return||n.return()}finally{if(u)throw a}}return i}}function I(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function g(t,e){return y(t)||b(t,e)||k(t,e)||I()}function k(t,e){if(t){if("string"==typeof t)return m(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?m(t,e):void 0}}function S(t,e){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!((a=(a=o.trys).length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=e.call(t,o)}catch(t){i=[6,t],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}}f=(h.then?(await h)():h)[0];const x=function(t){var e=t.patientUuid,n=(t.dateOfBirth,(0,o.useTranslation)().t),r=g((0,a.useState)([]),2),l=r[0],h=r[1],m=g((0,a.useState)([]),2),y=m[0],v=m[1],b=(0,c.useConfig)(),I=b.formNames,k=b.formUuids,x=b.encounterTypes,D=b.obsConcepts;(0,a.useEffect)((function(){!function(){V.apply(this,arguments)}()}),[]);var F=(0,a.useMemo)((function(){return[{key:"artProphylaxisStatus",header:n("artProphylaxisStatus","ART Prophylaxis Status"),encounterTypes:[x.infantPostnatal],getObsValue:function(t){var e=g(t,1)[0];return(0,u.hFx)(e,D.artProphylaxisStatus)}},{key:"breastfeeding",header:n("breastfeeding","Breastfeeding"),encounterTypes:[x.infantPostnatal],getObsValue:function(t){var e=g(t,1)[0];return(0,u.hFx)(e,D.breastfeedingStatus)}},{key:"hivStatus",header:n("hivStatus","HIV Status"),encounterTypes:[x.infantPostnatal],getObsValue:function(t){var e=g(t,1)[0];return(0,u.hFx)(e,D.finalTestResults)}},{key:"finalOutcome",header:n("finalOutcome","Final Outcome"),encounterTypes:[x.infantPostnatal],getObsValue:function(t){var e=g(t,1)[0];return(0,u.hFx)(e,D.outcomeStatus)}}]}),[]),w=(0,a.useMemo)((function(){return[{key:"date",header:n("date","Date"),getValue:function(t){return(0,u.hFx)(t,D.artStartDate,!0)}},{key:"testType",header:n("testType","Test Type"),getValue:function(t){return(0,u.hFx)(t,D.testTypeConcept)}},{key:"ageAtTimeOfTest",header:n("ageAtTimeOfTest","Age at time of test"),getValue:function(t){var e=(0,u.hFx)(t,D.artStartDate);return e?s()().diff(s()(e),"day"):"--"}},{key:"hivStatus",header:n("hivStatus","HIV Status"),getValue:function(t){return(0,u.hFx)(t,D.finalTestResults)}}]}),[]),O=[{key:"pTrackerId",header:n("pTrackerId","PTracker ID")},{key:"name",header:n("name","Name")},{key:"relationship",header:n("relationship","Relationship")},{key:"dateOfBirth",header:n("dateOfBirth","Date of birth")},{key:"hivStatus",header:n("hivStatus","HIV Status")}];function V(){return(V=T((function(){var t,n;return S(this,(function(r){switch(r.label){case 0:return t=[],[4,(0,u.IXl)(e)];case 1:return(null==(n=r.sent())?void 0:n.length)&&n.forEach((function(e){t.push(e)})),h(t),[2]}}))}))).apply(this,arguments)}function P(){return P=T((function(t){var e,n;return S(this,(function(r){switch(r.label){case 0:return e={patientId:"",pTrackerId:"--"},[4,(0,f.lP)(t)];case 1:return(n=r.sent())&&(e.pTrackerId=n.find((function(t){return t.identifierType.uuid===x.PTrackerIdentifierType})).identifier,e.patientId=t),[2,e]}}))})),P.apply(this,arguments)}(0,a.useEffect)((function(){var t=l.map((function(t){return function(t){return P.apply(this,arguments)}(t.personA.uuid)}));Promise.all(t).then((function(t){v(t.map((function(t){return{patientId:t.patientId,pTrackerId:t.pTrackerId}})))}))}),[l]);var C=(0,a.useMemo)((function(){var t=[];return l.forEach((function(e){var n,r=i().createElement(d.rUS,{onClick:function(t){t.preventDefault(),(0,c.navigate)({to:"".concat(u.sb4).concat(e.personA.uuid,"/chart")})}},e.personA.display),a={id:e.uuid,pTrackerId:null===(n=y.find((function(t){return t.patientId===e.personA.uuid})))||void 0===n?void 0:n.pTrackerId,name:r,relationship:e.relationshipType.displayAIsToB,dateOfBirth:s()(e.personA.birthdate).format("DD-MMM-YYYY"),hivStatus:"",finalOutcome:""};t.push(a)})),t}),[l,y]),E=(0,a.useMemo)((function(){return[{key:"visitType",header:n("visitType","Visit Type"),getValue:function(t){return t.encounterType.name}},{key:"visitDate",header:n("visitDate","Visit date"),getValue:function(t){return(0,u.hFx)(t,D.infantVisitDate,!0)}},{key:"facility",header:n("facility","Facility"),getValue:function(t){return t.location.name}},{key:"nextFollowUpDate",header:n("nextFollowUpDate","Next Follow-up date"),getValue:function(t){return(0,u.hFx)(t,D.followUpDateConcept,!0)}},{key:"actions",header:n("actions","Actions"),getValue:function(t){return[{form:{name:"Infant - Postanal Form",package:"child_health"},encounterUuid:t.uuid,intent:"*",label:n("viewDetails","View details"),mode:"view"}]}}]}),[]),A=n("previousVisitsSummary","Previous Visits");return i().createElement("div",null,i().createElement(u.eBf,{patientUuid:e,headerTitle:n("infantSummary","Infants Summary"),columns:F}),i().createElement(u.IOg,{patientUuid:e,encounterType:x.infantPostnatal,formList:[{name:I.infantPostnatal,uuid:k.infantPostnatal}],columns:w,description:n("hivMonitoring","HIV Monitoring"),headerTitle:n("hivMonitoring","HIV Monitoring"),launchOptions:{hideFormLauncher:!0,displayText:"",moduleName:p.moduleName}}),i().createElement(u.BRj,{headerTitle:n("family","Family"),patientUuid:e,headers:O,items:C,isActionable:!0,isStriped:!0,launchOptions:{hideFormLauncher:!0,moduleName:"",displayText:""}}),i().createElement(u.IOg,{patientUuid:e,encounterType:x.infantPostnatal,columns:E,description:A,headerTitle:A,formList:[{name:I.infantPostnatal,uuid:k.infantPostnatal}],launchOptions:{hideFormLauncher:!0,moduleName:p.moduleName,displayText:""}}))};r()}catch(D){r(D)}}))}}]);