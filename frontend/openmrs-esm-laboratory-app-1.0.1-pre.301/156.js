"use strict";(globalThis.webpackChunk_openmrs_esm_laboratory_app=globalThis.webpackChunk_openmrs_esm_laboratory_app||[]).push([[156],{4930:(e,t,r)=>{r.d(t,{c:()=>c});var n=r(6004),a=r.n(n),l=r(1056),o=r.n(l)()(a());o.push([e.id,"section{margin:.5rem}.-esm-laboratory__reject-lab-request-modal__sectionTitle___q87Au{margin-bottom:.75rem}.-esm-laboratory__reject-lab-request-modal__modalBody___GLqpQ{padding-bottom:1rem}","",{version:3,sources:["webpack://./src/lab-tabs/modals/reject-lab-request-modal.scss","webpack://./node_modules/@carbon/layout/scss/generated/_spacing.scss"],names:[],mappings:"AAGA,QACE,YCiBW,CDdb,iEACE,oBCkBW,CDfb,8DACE,mBCmBW",sourceRoot:""}]),o.locals={sectionTitle:"-esm-laboratory__reject-lab-request-modal__sectionTitle___q87Au",modalBody:"-esm-laboratory__reject-lab-request-modal__modalBody___GLqpQ"};const c=o},1156:(e,t,r)=>{r.r(t),r.d(t,{default:()=>A});var n=r(7244),a=r.n(n),l=r(4708),o=r(4652),c=r(3604),u=r.n(c),s=r(7200),i=r.n(s),d=r(8272),m=r.n(d),f=r(712),b=r.n(f),p=r(6768),y=r.n(p),h=r(2116),v=r.n(h),_=r(4930),g={};g.styleTagTransform=v(),g.setAttributes=b(),g.insert=m().bind(null,"head"),g.domAPI=i(),g.insertStyleElement=y(),u()(_.c,g);const E=_.c&&_.c.locals?_.c.locals:void 0;var C=r(8704),q=r(6612);function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function T(e,t,r,n,a,l,o){try{var c=e[l](o),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,a)}function j(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,l=[],o=!0,c=!1;try{for(r=r.call(e);!(o=(n=r.next()).done)&&(l.push(n.value),!t||l.length!==t);o=!0);}catch(e){c=!0,a=e}finally{try{o||null==r.return||r.return()}finally{if(c)throw a}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return w(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?w(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}const A=function(e){var t,r,c=e.order,u=e.closeModal,s=(0,o.useTranslation)().t,i=j((0,n.useState)(""),2),d=i[0],m=i[1],f=(0,C.useAbortController)(),b=j((0,n.useState)(!1),2),p=b[0],y=b[1],h=(t=function(e){return function(e,t){var r,n,a,l,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return l={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function c(l){return function(c){return function(l){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(a=2&l[0]?n.return:l[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,l[1])).done)return a;switch(n=0,a&&(l=[2&l[0],a.value]),l[0]){case 0:case 1:a=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,n=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!((a=(a=o.trys).length>0&&a[a.length-1])||6!==l[0]&&2!==l[0])){o=0;continue}if(3===l[0]&&(!a||l[1]>a[0]&&l[1]<a[3])){o.label=l[1];break}if(6===l[0]&&o.label<a[1]){o.label=a[1],a=l;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(l);break}a[2]&&o.ops.pop(),o.trys.pop();continue}l=t.call(e,o)}catch(e){l=[6,e],n=0}finally{r=a=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,c])}}}(this,(function(t){return e.preventDefault(),y(!0),(0,q.E9)(c.uuid,d,f).then((function(e){y(!1),u(),(0,C.showSnackbar)({isLowContrast:!0,title:s("rejectLabRequestTitle","Lab Request Rejected"),kind:"success",subtitle:s("rejectLabRequestSuccessMessage","You have successfully rejected a lab request with Order Number: ".concat(c.orderNumber,"."))})}),(function(e){y(!1),(0,C.showNotification)({title:s("errorRejectingRequest', 'Error Rejecting a lab request."),kind:"error",critical:!0,description:null==e?void 0:e.message})})),[2]}))},r=function(){var e=this,r=arguments;return new Promise((function(n,a){var l=t.apply(e,r);function o(e){T(l,n,a,o,c,"next",e)}function c(e){T(l,n,a,o,c,"throw",e)}o(void 0)}))},function(e){return r.apply(this,arguments)});return a().createElement("div",null,a().createElement(l.QFz,{onSubmit:h},a().createElement(l.kPY,{closeModal:u,title:"".concat(s("rejectLabRequest","Reject Lab Request")," [").concat(c.orderNumber,"]")}),a().createElement(l.aUI,null,a().createElement("div",{className:E.modalBody},a().createElement(l.ar0,null,a().createElement("p",{className:E.section},"".concat(s("testType","Test Type"),": ").concat(c.concept.display))),a().createElement("br",null),a().createElement(l.ar0,null,a().createElement(l.IF6,{labelText:s("fulfillerComment","Fulfiller Comment"),id:"commentField",maxCount:500,enableCounter:!0,onChange:function(e){return m(e.target.value)}})))),a().createElement(l._AC,null,a().createElement(l.qaq,{kind:"secondary",onClick:u},s("cancel","Cancel")),a().createElement(l.qaq,{kind:"danger",type:"submit",disabled:p},s("reject","Reject")))))}},6612:(e,t,r)=>{r.d(t,{A5:()=>o,E9:()=>u,_u:()=>c});var n=r(8704),a=r(4072),l=r(7244);function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=(0,n.useConfig)().laboratoryOrderTypeUuid,o=(0,l.useMemo)((function(){return"NEW"===e?null:e}),[e]),c="NEW"===e,u="".concat(n.restBaseUrl,"/order?orderTypes=").concat(r,"&v=full");u=o?u+"&fulfillerStatus=".concat(o):u,u=t?"".concat(u,"&excludeCanceledAndExpired=true&excludeDiscontinueOrders=true"):u;var s=e?5e3:null,i=(0,a.cp)(u,n.openmrsFetch,{refreshInterval:s}),d=i.data,m=i.error,f=i.mutate,b=i.isLoading;return{labOrders:(null==d?void 0:d.data)&&c&&d.data.results.filter((function(e){return"NEW"===(null==e?void 0:e.action)&&null===(null==e?void 0:e.fulfillerStatus)}))||(null==d?void 0:d.data.results)||[],isLoading:b,isError:m,mutate:f}}function c(e,t,r){return(0,n.openmrsFetch)("".concat(n.restBaseUrl,"/order/").concat(e,"/fulfillerdetails/"),{method:"POST",headers:{"Content-Type":"application/json"},signal:r.signal,body:{fulfillerStatus:t}})}function u(e,t,r){return(0,n.openmrsFetch)("".concat(n.restBaseUrl,"/order/").concat(e,"/fulfillerdetails/"),{method:"POST",headers:{"Content-Type":"application/json"},signal:r.signal,body:{fulfillerStatus:"DECLINED",fulfillerComment:t}})}}}]);