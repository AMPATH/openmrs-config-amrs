"use strict";(globalThis.webpackChunk_openmrs_esm_service_queues_app=globalThis.webpackChunk_openmrs_esm_service_queues_app||[]).push([[263],{4819:(e,t,n)=>{n.d(t,{Z:()=>s});var r=n(272),i=n.n(r),a=n(2609),o=n.n(a)()(i());o.push([e.id,":root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79;--bottom-nav-height: 4rem;--workspace-header-height: 3rem;--tablet-workspace-window-height: calc(100vh - var(--omrs-navbar-height));--desktop-workspace-window-height: calc(100vh - var(--omrs-navbar-height) - var(--workspace-header-height))}.-esm-service-queues__queue-entry-actons-modal__radioButtonGroup___VC7fE{display:flex;flex-direction:column;align-items:flex-start;margin-top:.5rem;min-height:4rem;width:100%;font-size:var(--cds-body-compact-01-font-size, 0.875rem);font-weight:var(--cds-body-compact-01-font-weight, 400);line-height:var(--cds-body-compact-01-line-height, 1.28572);letter-spacing:var(--cds-body-compact-01-letter-spacing, 0.16px)}.-esm-service-queues__queue-entry-actons-modal__radioButton___KY_tG{padding:.25rem .25rem;margin:.5rem 0}section{margin:.5rem}.-esm-service-queues__queue-entry-actons-modal__sectionTitle___jB8wo{font-size:var(--cds-heading-compact-02-font-size, 1rem);font-weight:var(--cds-heading-compact-02-font-weight, 600);line-height:var(--cds-heading-compact-02-line-height, 1.375);letter-spacing:var(--cds-heading-compact-02-letter-spacing, 0);color:#525252;margin-bottom:.75rem}.-esm-service-queues__queue-entry-actons-modal__queueEntryActionModalBody___f5dUG{padding-bottom:1rem}.-esm-service-queues__queue-entry-actons-modal__dateTimeFields___OF7ni{display:flex}","",{version:3,sources:["webpack://./../../node_modules/@openmrs/esm-styleguide/src/_vars.scss","webpack://./src/queue-table/queue-entry-actions/queue-entry-actons-modal.scss","webpack://./../../node_modules/@carbon/layout/scss/generated/_spacing.scss","webpack://./../../node_modules/@carbon/type/scss/_styles.scss"],names:[],mappings:"AAoDA,MACE,mBAAA,CACA,mBAAA,CACA,mBAAA,CACA,yBAAA,CACA,+BAAA,CACA,yEAAA,CACA,2GAAA,CCvDF,yEACE,YAAA,CACA,qBAAA,CACA,sBAAA,CACA,gBCaW,CDZX,eC+CW,CD9CX,UAAA,CEw1BE,wDAAA,CAAA,uDAAA,CAAA,2DAAA,CAAA,gEAAA,CFp1BJ,oEACE,qBAAA,CACA,cAAA,CAGF,QACE,YCCW,CDEb,qEE20BI,uDAAA,CAAA,0DAAA,CAAA,4DAAA,CAAA,8DAAA,CFz0BF,aDpBQ,CCqBR,oBAAA,CAGF,kFACE,mBCCW,CDEb,uEACE,YAAA",sourceRoot:""}]),o.locals={radioButtonGroup:"-esm-service-queues__queue-entry-actons-modal__radioButtonGroup___VC7fE",radioButton:"-esm-service-queues__queue-entry-actons-modal__radioButton___KY_tG",sectionTitle:"-esm-service-queues__queue-entry-actons-modal__sectionTitle___jB8wo",queueEntryActionModalBody:"-esm-service-queues__queue-entry-actons-modal__queueEntryActionModalBody___f5dUG",dateTimeFields:"-esm-service-queues__queue-entry-actons-modal__dateTimeFields___OF7ni"};const s=o},6124:(e,t,n)=>{n.d(t,{Z:()=>O});var r=n(8427),i=n(2870),a=n(8879),o=n.n(a),s=n(5206),u=n.n(s),l=n(4924),c=n(8179),d=n(88),m=n(9561),A=n(2312),p=n(1354),f=n.n(p),y=n(1583),v=n.n(y),h=n(7378),g=n.n(h),_=n(5993),b=n.n(_),C=n(4154),E=n.n(C),T=n(8141),w=n.n(T),q=n(4819),D={};D.styleTagTransform=w(),D.setAttributes=b(),D.insert=g().bind(null,"head"),D.domAPI=v(),D.insertStyleElement=E(),f()(q.Z,D);const S=q.Z&&q.Z.locals?q.Z.locals:void 0;function B(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function P(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){P(e,t,n[t])}))}return e}function F(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function x(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a=[],o=!0,s=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);o=!0);}catch(e){s=!0,i=e}finally{try{o||null==n.return||n.return()}finally{if(s)throw i}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return B(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?B(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}const O=function(e){var t,n=e.queueEntry,a=e.closeModal,p=e.modalParams,f=(0,l.useTranslation)().t,y=(0,m.Q)().mutateQueueEntries,v=p.modalTitle,h=p.modalInstruction,g=p.submitButtonText,_=p.submitSuccessTitle,b=p.submitSuccessText,C=p.submitFailureTitle,E=p.submitAction,T=p.disableSubmit,w=p.isTransition?new Date:new Date(n.startedAt),q=x((0,s.useState)({selectedQueue:n.queue.uuid,selectedPriority:n.priority.uuid,selectedStatus:n.status.uuid,prioritycomment:null!==(t=n.priorityComment)&&void 0!==t?t:"",modifyDefaultTransitionDateTime:!1,transitionDate:w,transitionTime:o()(w).format("hh:mm"),transitionTimeFormat:o()(w).hour()<12?"AM":"PM"}),2),D=q[0],B=q[1],P=(0,A.y)().queues,O=x((0,s.useState)(!1),2),j=O[0],M=O[1],Q=P.find((function(e){return e.uuid==D.selectedQueue})),N=null==Q?void 0:Q.allowedStatuses,I=Q&&0==N.length,G=null==Q?void 0:Q.allowedPriorities,z=Q&&0==G.length,U=(0,s.useMemo)((function(){var e=new Date,t=new Date(D.transitionDate),n=x((0,d.A)(D.transitionTime,D.transitionTimeFormat),2),r=n[0],i=n[1];return t.setHours(r,i,0,0),t>e}),[D.transitionDate,D.transitionTime,D.transitionTimeFormat]),V=G.findIndex((function(e){return e.uuid==D.selectedPriority}));return u().createElement(u().Fragment,null,u().createElement(r.xBx,{closeModal:a,title:v}),u().createElement(r.fef,null,u().createElement("div",{className:S.queueEntryActionModalBody},u().createElement(r.Kqy,{gap:4},u().createElement("h5",null,n.display),u().createElement("p",null,h),u().createElement("section",{className:S.section},u().createElement("div",{className:S.sectionTitle},f("serviceQueue","Service queue")),u().createElement(r.PhF,{labelText:f("selectQueue","Select a queue"),id:"queue",invalidText:"Required",value:D.selectedQueue,onChange:function(e){return function(e){var t,n,r=P.find((function(t){return t.uuid==e})),i=r.allowedStatuses,a=r.allowedPriorities,o=i.find((function(e){return e.uuid==D.selectedStatus})),s=a.find((function(e){return e.uuid==D.selectedPriority}));B(F(k({},D),{selectedQueue:e,selectedStatus:o?D.selectedStatus:null===(t=i[0])||void 0===t?void 0:t.uuid,selectedPriority:s?D.selectedPriority:null===(n=a[0])||void 0===n?void 0:n.uuid}))}(e.target.value)}},null==P?void 0:P.map((function(e){var t=e.uuid,i=e.display;return u().createElement(r.QlF,{key:t,text:t==n.queue.uuid?f("currentValueFormatted","{{value}} (Current)",{value:i,interpolation:{escapeValue:!1}}):i,value:t})})))),u().createElement("section",null,u().createElement("div",{className:S.sectionTitle},f("queueStatus","Queue status")),I?u().createElement(r.K0D,{kind:"error",lowContrast:!0,subtitle:f("configureStatus","Please configure status to continue."),title:f("noStatusConfigured","No status configured")}):u().createElement(r.SYO,{name:"status",valueSelected:D.selectedStatus,onChange:function(e){var t;t=e,B(F(k({},D),{selectedStatus:t}))}},null==N?void 0:N.map((function(e){var t=e.uuid,i=e.display;return u().createElement(r.EUY,{key:t,name:i,labelText:t==n.status.uuid?f("currentValueFormatted","{{value}} (Current)",{value:i,interpolation:{escapeValue:!1}}):i,value:t})})))),u().createElement("section",{className:S.section},u().createElement("div",{className:S.sectionTitle},f("queuePriority","Queue priority")),z?u().createElement(r.K0D,{className:S.inlineNotification,kind:"error",lowContrast:!0,subtitle:f("configurePriorities","Please configure priorities to continue."),title:f("noPrioritiesConfigured","No priorities configured")}):u().createElement(r.GHR,{size:"sm",selectedIndex:V,onChange:function(e){var t;t=e.name,B(F(k({},D),{selectedPriority:t}))}},null==G?void 0:G.map((function(e){var t=e.uuid,i=e.display;return u().createElement(r.rsf,{role:"radio",name:t,text:t==n.priority.uuid?f("currentValueFormatted","{{value}} (Current)",{value:i,interpolation:{escapeValue:!1}}):i,key:t,value:t})})))),u().createElement("section",{className:S.section},u().createElement("div",{className:S.sectionTitle},f("priorityComment","Priority comment")),u().createElement(r.Kx8,{labelText:"",value:D.prioritycomment,onChange:function(e){return t=e.target.value,void B(F(k({},D),{prioritycomment:t}));var t},placeholder:f("enterCommentHere","Enter comment here")})),u().createElement("section",{className:S.section},u().createElement("div",{className:S.sectionTitle},f("timeOfTransition","Time of transition")),u().createElement(r.XZJ,{labelText:f("modifyDefaultValue","Modify default value"),id:"modifyTransitionTime",checked:D.modifyDefaultTransitionDateTime,onChange:function(e,t){var n;n=t.checked,B(F(k({},D),{modifyDefaultTransitionDateTime:n}))}}),u().createElement("div",{className:S.dateTimeFields},u().createElement(r.Mtg,{datePickerType:"single",dateFormat:c.eJ,value:D.transitionDate,maxDate:(new Date).setHours(23,59,59,59),onChange:function(e){var t;t=x(e,1)[0],B(F(k({},D),{transitionDate:t}))}},u().createElement(r.aj6,{id:"datePickerInput",labelText:f("date","Date"),placeholder:c.rQ,disabled:!D.modifyDefaultTransitionDateTime})),u().createElement(r.jII,{labelText:f("time","Time"),onChange:function(e){return t=e.target.value,void B(F(k({},D),{transitionTime:t}));var t},pattern:c.ox,value:D.transitionTime,invalid:U,invalidText:f("timeCannotBeInFuture","Time cannot be in the future"),disabled:!D.modifyDefaultTransitionDateTime},u().createElement(r.M6n,{id:"visitStartTimeSelect",onChange:function(e){return t=e.target.value,void B(F(k({},D),{transitionTimeFormat:t}));var t},value:D.transitionTimeFormat,labelText:f("time","Time"),"aria-label":f("time","Time")},u().createElement(r.QlF,{value:"AM",text:"AM"}),u().createElement(r.QlF,{value:"PM",text:"PM"})))))))),u().createElement(r.mzw,null,u().createElement(r.zxk,{kind:"secondary",onClick:a},f("cancel","Cancel")),u().createElement(r.zxk,{disabled:j||T(n,D),onClick:function(e){e.preventDefault(),M(!0),E(n,D).then((function(e){if(200!==e.status)throw{message:f("unexpectedServerResponse","Unexpected Server Response")};(0,i.showSnackbar)({isLowContrast:!0,title:_,kind:"success",subtitle:b}),y(),a()})).catch((function(e){(0,i.showSnackbar)({title:C,kind:"error",subtitle:null==e?void 0:e.message})})).finally((function(){M(!1)}))}},g)))}},7702:(e,t,n)=>{n.d(t,{VK:()=>o,hu:()=>s,rf:()=>i,zI:()=>a});var r=n(2870);function i(e,t){return(0,r.openmrsFetch)("".concat(r.restBaseUrl,"/queue-entry/transition"),{method:"POST",headers:{"Content-Type":"application/json"},signal:null==t?void 0:t.signal,body:e})}function a(e,t,n){return(0,r.openmrsFetch)("".concat(r.restBaseUrl,"/queue-entry/").concat(e),{method:"POST",headers:{"Content-Type":"application/json"},signal:null==n?void 0:n.signal,body:t})}function o(e,t){return(0,r.openmrsFetch)("".concat(r.restBaseUrl,"/queue-entry/transition"),{method:"DELETE",headers:{"Content-Type":"application/json"},signal:null==t?void 0:t.signal,body:e})}function s(e,t){return(0,r.openmrsFetch)("".concat(r.restBaseUrl,"/queue-entry/").concat(e),{method:"DELETE",headers:{"Content-Type":"application/json"},signal:null==t?void 0:t.signal})}}}]);